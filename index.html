<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f17" />
  <link rel="manifest" href="/manifest.webmanifest" />
  <title>Infinite Roguelite â€” PWA</title>
  <style>
    :root {
      --bg:#0b0f17; --panel:#111827; --panel-2:#0f172a; --ink:#e5e7eb; --muted:#94a3b8; --accent:#22d3ee; --ok:#34d399; --warn:#fbbf24; --bad:#fb7185;
      --hudw: 280px; --barh: 44px; --btnh: 32px; --radius: 10px; --shadow: 0 8px 24px rgba(0,0,0,.35);
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:14px/1.35 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Helvetica Neue',Arial;}
    #wrap{position:fixed;inset:0;display:grid;grid-template-columns: var(--hudw) 1fr; grid-template-rows: var(--barh) 1fr; gap:8px; padding:8px; box-sizing:border-box;}
    #top{grid-column:1/3;display:flex;align-items:center;gap:8px;background:linear-gradient(180deg,rgba(255,255,255,.04),transparent);border-radius:12px;padding:8px 10px}
    .pill{padding:6px 10px;background:var(--panel);border:1px solid #1f2937;border-radius:999px;display:inline-flex;align-items:center;gap:8px}
    .btn{height:var(--btnh);padding:0 12px;border-radius:8px;border:1px solid #293241;background:#0d1320;color:var(--ink);cursor:pointer}
    .btn[disabled]{opacity:.45;cursor:not-allowed}
    .btn.acc{border-color:#0ea5b7;background:#07141a}
    .btn.ok{border-color:#10b981;background:#071a14}
    .btn.warn{border-color:#f59e0b;background:#1a1407}
    #hud{grid-row:2;grid-column:1;display:flex;flex-direction:column;gap:8px}
    .card{background:var(--panel);border:1px solid #1f2937;border-radius:12px;box-shadow:var(--shadow)}
    #stats{padding:10px}
    #stats h3{margin:0 0 6px 0;font-size:13px;color:var(--muted);font-weight:600;letter-spacing:.02em}
    #stats .kv{display:grid;grid-template-columns: 1fr auto;gap:6px 10px}
    #stats .kv div{padding:4px 6px;background:var(--panel-2);border:1px solid #0b1220;border-radius:6px}
    #abilities{padding:10px}
    #abilities h3{margin:0 0 8px 0;color:var(--muted)}
    .ab{display:grid;grid-template-columns: 1fr auto;gap:6px;align-items:center;margin-bottom:6px}
    .ab .cd{font-variant-numeric:tabular-nums;color:var(--muted)}
    #toast{position:fixed;left:50%;top:70px;transform:translateX(-50%);z-index:10;pointer-events:none}
    #toast .bubble{padding:10px 14px;border-radius:999px;background:#0d1320;border:1px solid #23304a;box-shadow:var(--shadow)}
    #canvaswrap{position:relative;grid-row:2;grid-column:2;background:#05070d;border:1px solid #1f2937;border-radius:12px;overflow:hidden}
    #game{display:block;width:100%;height:100%}
    #dead, #menu, #meta{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,12,.7);backdrop-filter:blur(2px)}
    .panel{width:min(720px,94%);background:var(--panel);border:1px solid #243043;border-radius:14px;padding:16px;box-shadow:var(--shadow)}
    .panel h2{margin:0 0 8px 0}
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
    .shop-item{display:flex;align-items:center;justify-content:space-between;background:var(--panel-2);border:1px solid #122039;padding:8px;border-radius:10px}
    .price{color:var(--warn)}
    .small{font-size:12px;color:var(--muted)}
    #meta .panel{width:min(880px,96%)}
    .row{display:flex;gap:8px;flex-wrap:wrap}
  </style>
</head>
<body>
  <div id="wrap">
    <div id="top">
      <div class="pill">ðŸ’° Gold: <b id="gold">0</b></div>
      <div class="pill">âœ¦ Shards: <b id="shards">0</b></div>
      <div class="pill">Depth: <b id="depth">0</b></div>
      <button class="btn ok" id="runBtn">Run</button>
      <button class="btn" id="pauseBtn">Pause</button>
      <button class="btn acc" id="metaBtn">Meta Upgrades</button>
      <button class="btn" id="installBtn" hidden>Install</button>
    </div>

    <div id="hud">
      <div class="card" id="stats">
        <h3>Run Stats</h3>
        <div class="kv">
          <div>DMG</div><div id="statDMG">0%</div>
          <div>Fire Rate</div><div id="statFR">0/s</div>
          <div>Projectiles</div><div id="statProj">1</div>
          <div>Spread</div><div id="statSpread">0Â°</div>
          <div>Move Speed</div><div id="statSpd">100%</div>
          <div>Max HP</div><div id="statHP">5</div>
          <div>Gold Mult</div><div id="statGoldMult">1.00Ã—</div>
          <div>Shard Mult</div><div id="statShardMult">1.00Ã—</div>
        </div>
      </div>
      <div class="card" id="abilities">
        <h3>Gold Abilities (press 1â€“5)</h3>
        <div class="ab"><div>1) Dash</div>
          <div><span class="cd" id="cdDash">Not owned</span> <button class="btn" id="buyDash">Buy 50</button></div>
        </div>
        <div class="ab"><div>2) Shield</div>
          <div><span class="cd" id="cdShield">Not owned</span> <button class="btn" id="buyShield">Buy 80</button></div>
        </div>
        <div class="ab"><div>3) Nuke</div>
          <div><span class="cd" id="cdNuke">Not owned</span> <button class="btn" id="buyNuke">Buy 120</button></div>
        </div>
        <div class="ab"><div>4) Heal</div>
          <div><span class="cd" id="cdHeal">Not owned</span> <button class="btn" id="buyHeal">Buy 60</button></div>
        </div>
        <div class="ab"><div>5) Turret</div>
          <div><span class="cd" id="cdTurret">Not owned</span> <button class="btn" id="buyTurret">Buy 100</button></div>
        </div>
        <div class="small">Abilities have cooldowns; prices scale slightly by depth.</div>
      </div>
    </div>

    <div id="canvaswrap">
      <canvas id="game" width="1280" height="720"></canvas>

      <div id="toast"><div class="bubble" id="toastMsg" hidden>Room clear â€” exit U / D / L / R</div></div>

      <div id="menu">
        <div class="panel">
          <h2>Infinite Roguelite</h2>
          <p class="small">WASD/Arrows move, mouse auto-aims & shoots. 1â€“5 abilities. P pause/resume. M meta shop.</p>
          <div class="row">
            <button class="btn ok" id="menuRun">Start Run</button>
            <button class="btn acc" id="menuMeta">Meta Upgrades</button>
          </div>
        </div>
      </div>

      <div id="dead">
        <div class="panel">
          <h2>Run Over</h2>
          <p id="deathSummary">You reached Depth 0.</p>
          <div class="row">
            <button class="btn ok" id="againBtn">Run Again</button>
            <button class="btn acc" id="deadMetaBtn">Meta Upgrades</button>
          </div>
        </div>
      </div>

      <div id="meta">
        <div class="panel">
          <h2>Meta Upgrades (Shards âœ¦)</h2>
          <div class="grid" id="metaGrid"></div>
          <div class="row" style="margin-top:8px">
            <button class="btn" id="closeMeta">Close</button>
          </div>
          <p class="small">Upgrades are permanent and stack. Endless upgrades scale in cost.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Vite entry -->
  <script type="module" src="/src/main.js"></script>
</body>
</html>
